(function(){var e=document.getElementById("search"),t=document.getElementById("search-wrap"),n=document.getElementById("key"),i=document.getElementById("back"),s=document.getElementById("search-panel"),o=document.getElementById("search-result"),r=document.getElementById("search-tpl").innerHTML,c;function a(e){if(!c){var t=new XMLHttpRequest;t.open("GET","/content.json",true);t.onload=function(){if(this.status>=200&&this.status<300){var t=JSON.parse(this.response);c=t instanceof Array?t:t.posts;e(c)}else{console.error(this.statusText)}};t.onerror=function(){console.error(this.statusText)};t.send()}else{e(c)}}function u(e,t){return e.replace(/\{\w+\}/g,function(e){var n=e.replace(/\{|\}/g,"");return t[n]||""})}var d=document[navigator.userAgent.indexOf("Firefox")!==-1?"documentElement":"body"],l=function(){};var f={show:function(){window.innerWidth<760?d.classList.add("lock-size"):l;s.classList.add("in")},hide:function(){window.innerWidth<760?d.classList.remove("lock-size"):l;s.classList.remove("in")}};function m(e){var t="";if(e.length){t=e.map(function(e){return u(r,{title:e.title,path:e.path,date:new Date(e.date).toLocaleDateString(),tags:e.tags.map(function(e){return"<span>#"+e.name+"</span>"}).join("")})}).join("")}else{t='<li class="tips"><i class="icon icon-coffee icon-3x"></i><p>Results not found!</p></li>'}o.innerHTML=t}function g(e,t){t.lastIndex=0;return t.test(e)}function p(e,t){return g(e.title,t)||e.tags.some(function(e){return g(e.name,t)})||g(e.text,t)}function v(e){var t=this.value.trim();if(!t){return}var n=new RegExp(t.replace(/[ ]/g,"|"),"gmi");a(function(e){var t=e.filter(function(e){return p(e,n)});m(t);f.show()});e.preventDefault()}e.addEventListener("click",function(){t.classList.toggle("in");n.value="";document.getElementById("key").focus()});i.addEventListener("click",function(){t.classList.remove("in");f.hide()});document.addEventListener("click",function(e){if(e.target.id!=="key"){f.hide()}});n.addEventListener("input",v);n.addEventListener("click",v)})();