(function(){var e=document.getElementById("search"),t=document.getElementById("search-wrap"),n=document.getElementById("key"),i=document.getElementById("back"),s=document.getElementById("search-panel"),r=document.getElementById("search-result"),o=document.getElementById("search-tpl").innerHTML,a;function c(e){if(!a){var t=new XMLHttpRequest;t.open("GET","/content.json",true);t.onload=function(){if(this.status>=200&&this.status<300){var t=JSON.parse(this.response);a=t instanceof Array?t:t.posts;e(a)}else{console.error(this.statusText)}};t.onerror=function(){console.error(this.statusText)};t.send()}else{e(a)}}function u(e,t){return e.replace(/\{\w+\}/g,function(e){var n=e.replace(/\{|\}/g,"");return t[n]||""})}var l=document[navigator.userAgent.indexOf("Firefox")!==-1?"documentElement":"body"],d=function(){};var f={show:function(){window.innerWidth<760?l.classList.add("lock-size"):d;s.classList.add("in")},hide:function(){window.innerWidth<760?l.classList.remove("lock-size"):d;s.classList.remove("in")}};function m(e){var t="";if(e.length){t=e.map(function(e){return u(o,{title:e.title,path:e.path,date:new Date(e.date).toLocaleDateString(),tags:e.tags.map(function(e){return"<span>#"+e.name+"</span>"}).join("")})}).join("")}else{t='<li class="tips"><i class="icon icon-coffee icon-3x"></i><p>Results not found!</p></li>'}r.innerHTML=t}function p(e,t){t.lastIndex=0;return t.test(e)}function g(e,t){return p(e.title,t)||e.tags.some(function(e){return p(e.name,t)})||p(e.text,t)}function v(e){var t=this.value.trim();if(!t){return}var n=new RegExp(t.replace(/[ ]/g,"|"),"gmi");c(function(e){var t=e.filter(function(e){return g(e,n)});m(t);f.show()});e.preventDefault()}e.addEventListener("click",function(){t.classList.toggle("in");n.value=""});i.addEventListener("click",function(){t.classList.remove("in");f.hide()});document.addEventListener("click",function(e){if(e.target.id!=="key"){f.hide()}});n.addEventListener("input",v);n.addEventListener("click",v)})();